{% if var("attribution_warehouse_ad_campaign_sources") and var("attribution_warehouse_event_sources") %}
{% if target.type == 'snowflake' %}

{{
    config(
      alias='ad_spend_roi_fact',
      materialized='table'
    )
}}

with ad_campaign_stats as (
  select
    *
  from
    {{ ref('wh_ad_campaign_performance_fact') }}
),
  revenue_attribution as (
    select
      date_trunc('DAY',converted_ts) as converted_ts,
      platform,
      campaign_id,
      ad_group_id,
      sum(user_registration_first_click_attrib_conversions) user_registration_first_click_attrib_conversions,
      sum(user_registration_first_non_direct_click_attrib_conversions) user_registration_first_non_direct_click_attrib_conversions,
      sum(user_registration_first_paid_click_attrib_conversions) user_registration_first_paid_click_attrib_conversions,
      sum(user_registration_last_click_attrib_conversions) user_registration_last_click_attrib_conversions,
      sum(user_registration_last_non_direct_click_attrib_conversions) user_registration_last_non_direct_click_attrib_conversions,
      sum(user_registration_last_paid_click_attrib_conversions) user_registration_last_paid_click_attrib_conversions,
      sum(user_registration_even_click_attrib_conversions) user_registration_even_click_attrib_conversions,
      sum(user_registration_time_decay_attrib_conversions) user_registration_time_decay_attrib_conversions,
      sum(first_order_first_click_attrib_conversions) first_order_first_click_attrib_conversions,
      sum(first_order_first_non_direct_click_attrib_conversions) first_order_first_non_direct_click_attrib_conversions,
      sum(first_order_first_paid_click_attrib_conversions) first_order_first_paid_click_attrib_conversions,
      sum(first_order_last_click_attrib_conversions) first_order_last_click_attrib_conversions,
      sum(first_order_last_non_direct_click_attrib_conversions) first_order_last_non_direct_click_attrib_conversions,
      sum(first_order_last_paid_click_attrib_conversions) first_order_last_paid_click_attrib_conversions,
      sum(first_order_even_click_attrib_conversions) first_order_even_click_attrib_conversions,
      sum(first_order_time_decay_attrib_conversions) first_order_time_decay_attrib_conversions,
      sum(first_order_first_click_attrib_revenue_local_currency) first_order_first_click_attrib_revenue_local_currency,
      sum(first_order_first_click_attrib_revenue_global_currency) first_order_first_click_attrib_revenue_global_currency,
      sum(first_order_first_non_direct_click_attrib_revenue_local_currency) first_order_first_non_direct_click_attrib_revenue_local_currency,
      sum(first_order_first_non_direct_click_attrib_revenue_global_currency) first_order_first_non_direct_click_attrib_revenue_global_currency,
      sum(first_order_first_paid_click_attrib_revenue_local_currency) first_order_first_paid_click_attrib_revenue_local_currency,
      sum(first_order_first_paid_click_attrib_revenue_global_currency) first_order_first_paid_click_attrib_revenue_global_currency,
      sum(first_order_last_click_attrib_revenue_local_currency) first_order_last_click_attrib_revenue_local_currency,
      sum(first_order_last_click_attrib_revenue_global_currency) first_order_last_click_attrib_revenue_global_currency,
      sum(first_order_last_non_direct_click_attrib_revenue_local_currency) first_order_last_non_direct_click_attrib_revenue_local_currency,
      sum(first_order_last_non_direct_click_attrib_revenue_global_currency) first_order_last_non_direct_click_attrib_revenue_global_currency,
      sum(first_order_last_paid_click_attrib_revenue_local_currency) first_order_last_paid_click_attrib_revenue_local_currency,
      sum(first_order_last_paid_click_attrib_revenue_global_currency) first_order_last_paid_click_attrib_revenue_global_currency,
      sum(first_order_even_click_attrib_revenue_local_currency) first_order_even_click_attrib_revenue_local_currency,
      sum(first_order_even_click_attrib_revenue_global_currency) first_order_even_click_attrib_revenue_global_currency,
      sum(first_order_time_decay_attrib_revenue_local_currency) first_order_time_decay_attrib_revenue_local_currency,
      sum(first_order_time_decay_attrib_revenue_global_currency) first_order_time_decay_attrib_revenue_global_currency,
      sum(first_order_first_click_total_lifetime_value_30d_local_currency) first_order_first_click_total_lifetime_value_30d_local_currency,
      sum(first_order_first_click_total_lifetime_value_30d_global_currency) first_order_first_click_total_lifetime_value_30d_global_currency,
      sum(first_order_first_non_direct_click_total_lifetime_value_30d_local_currency) first_order_first_non_direct_click_total_lifetime_value_30d_local_currency,
      sum(first_order_first_non_direct_click_total_lifetime_value_30d_global_currency) first_order_first_non_direct_click_total_lifetime_value_30d_global_currency,
      sum(first_order_last_click_total_lifetime_value_30d_local_currency) first_order_last_click_total_lifetime_value_30d_local_currency,
      sum(first_order_last_click_total_lifetime_value_30d_global_currency) first_order_last_click_total_lifetime_value_30d_global_currency,
      sum(first_order_last_non_direct_click_total_lifetime_value_30d_local_currency) first_order_last_non_direct_click_total_lifetime_value_30d_local_currency,
      sum(first_order_last_non_direct_click_total_lifetime_value_30d_global_currency) first_order_last_non_direct_click_total_lifetime_value_30d_global_currency,
      sum(first_order_last_paid_click_total_lifetime_value_30d_local_currency) first_order_last_paid_click_total_lifetime_value_30d_local_currency,
      sum(first_order_last_paid_click_total_lifetime_value_30d_global_currency) first_order_last_paid_click_total_lifetime_value_30d_global_currency,
      sum(first_order_even_click_total_lifetime_value_30d_local_currency) first_order_even_click_total_lifetime_value_30d_local_currency,
      sum(first_order_even_click_total_lifetime_value_30d_global_currency) first_order_even_click_total_lifetime_value_30d_global_currency,
      sum(first_order_time_decay_total_lifetime_value_30d_local_currency) first_order_time_decay_total_lifetime_value_30d_local_currency,
      sum(first_order_time_decay_total_lifetime_value_30d_global_currency) first_order_time_decay_total_lifetime_value_30d_global_currency,
      sum(first_order_first_click_total_lifetime_value_60d_local_currency) first_order_first_click_total_lifetime_value_60d_local_currency,
      sum(first_order_first_click_total_lifetime_value_60d_global_currency) first_order_first_click_total_lifetime_value_60d_global_currency,
      sum(first_order_first_non_direct_click_total_lifetime_value_60d_local_currency) first_order_first_non_direct_click_total_lifetime_value_60d_local_currency,
      sum(first_order_first_non_direct_click_total_lifetime_value_60d_global_currency) first_order_first_non_direct_click_total_lifetime_value_60d_global_currency,
      sum(first_order_last_click_total_lifetime_value_60d_local_currency) first_order_last_click_total_lifetime_value_60d_local_currency,
      sum(first_order_last_click_total_lifetime_value_60d_global_currency) first_order_last_click_total_lifetime_value_60d_global_currency,
      sum(first_order_last_non_direct_click_total_lifetime_value_60d_local_currency) first_order_last_non_direct_click_total_lifetime_value_60d_local_currency,
      sum(first_order_last_non_direct_click_total_lifetime_value_60d_global_currency) first_order_last_non_direct_click_total_lifetime_value_60d_global_currency,
      sum(first_order_last_paid_click_total_lifetime_value_60d_local_currency) first_order_last_paid_click_total_lifetime_value_60d_local_currency,
      sum(first_order_last_paid_click_total_lifetime_value_60d_global_currency) first_order_last_paid_click_total_lifetime_value_60d_global_currency,
      sum(first_order_even_click_total_lifetime_value_60d_local_currency) first_order_even_click_total_lifetime_value_60d_local_currency,
      sum(first_order_even_click_total_lifetime_value_60d_global_currency) first_order_even_click_total_lifetime_value_60d_global_currency,
      sum(first_order_time_decay_total_lifetime_value_60d_local_currency) first_order_time_decay_total_lifetime_value_60d_local_currency,
      sum(first_order_time_decay_total_lifetime_value_60d_global_currency) first_order_time_decay_total_lifetime_value_60d_global_currency,
      sum(first_order_first_click_total_lifetime_value_90d_local_currency) first_order_first_click_total_lifetime_value_90d_local_currency,
      sum(first_order_first_click_total_lifetime_value_90d_global_currency) first_order_first_click_total_lifetime_value_90d_global_currency,
      sum(first_order_first_non_direct_click_total_lifetime_value_90d_local_currency) first_order_first_non_direct_click_total_lifetime_value_90d_local_currency,
      sum(first_order_first_non_direct_click_total_lifetime_value_90d_global_currency) first_order_first_non_direct_click_total_lifetime_value_90d_global_currency,
      sum(first_order_last_click_total_lifetime_value_90d_local_currency) first_order_last_click_total_lifetime_value_90d_local_currency,
      sum(first_order_last_click_total_lifetime_value_90d_global_currency) first_order_last_click_total_lifetime_value_90d_global_currency,
      sum(first_order_last_non_direct_click_total_lifetime_value_90d_local_currency) first_order_last_non_direct_click_total_lifetime_value_90d_local_currency,
      sum(first_order_last_non_direct_click_total_lifetime_value_90d_global_currency) first_order_last_non_direct_click_total_lifetime_value_90d_global_currency,
      sum(first_order_last_paid_click_total_lifetime_value_90d_local_currency) first_order_last_paid_click_total_lifetime_value_90d_local_currency,
      sum(first_order_last_paid_click_total_lifetime_value_90d_global_currency) first_order_last_paid_click_total_lifetime_value_90d_global_currency,
      sum(first_order_even_click_total_lifetime_value_90d_local_currency) first_order_even_click_total_lifetime_value_90d_local_currency,
      sum(first_order_even_click_total_lifetime_value_90d_global_currency) first_order_even_click_total_lifetime_value_90d_global_currency,
      sum(first_order_time_decay_total_lifetime_value_90d_local_currency) first_order_time_decay_total_lifetime_value_90d_local_currency,
      sum(first_order_time_decay_total_lifetime_value_90d_global_currency) first_order_time_decay_total_lifetime_value_90d_global_currency,
      sum(first_order_first_click_total_lifetime_value_180d_local_currency) first_order_first_click_total_lifetime_value_180d_local_currency,
      sum(first_order_first_click_total_lifetime_value_180d_global_currency) first_order_first_click_total_lifetime_value_180d_global_currency,
      sum(first_order_first_non_direct_click_total_lifetime_value_180d_local_currency) first_order_first_non_direct_click_total_lifetime_value_180d_local_currency,
      sum(first_order_first_non_direct_click_total_lifetime_value_180d_global_currency) first_order_first_non_direct_click_total_lifetime_value_180d_global_currency,
      sum(first_order_last_click_total_lifetime_value_180d_local_currency) first_order_last_click_total_lifetime_value_180d_local_currency,
      sum(first_order_last_click_total_lifetime_value_180d_global_currency) first_order_last_click_total_lifetime_value_180d_global_currency,
      sum(first_order_last_non_direct_click_total_lifetime_value_180d_local_currency) first_order_last_non_direct_click_total_lifetime_value_180d_local_currency,
      sum(first_order_last_non_direct_click_total_lifetime_value_180d_global_currency) first_order_last_non_direct_click_total_lifetime_value_180d_global_currency,
      sum(first_order_last_paid_click_total_lifetime_value_180d_local_currency) first_order_last_paid_click_total_lifetime_value_180d_local_currency,
      sum(first_order_last_paid_click_total_lifetime_value_180d_global_currency) first_order_last_paid_click_total_lifetime_value_180d_global_currency,
      sum(first_order_even_click_total_lifetime_value_180d_local_currency) first_order_even_click_total_lifetime_value_180d_local_currency,
      sum(first_order_even_click_total_lifetime_value_180d_global_currency) first_order_even_click_total_lifetime_value_180d_global_currency,
      sum(first_order_time_decay_total_lifetime_value_180d_local_currency) first_order_time_decay_total_lifetime_value_180d_local_currency,
      sum(first_order_time_decay_total_lifetime_value_180d_global_currency) first_order_time_decay_total_lifetime_value_180d_global_currency,
      sum(first_order_first_click_total_lifetime_value_365d_local_currency) first_order_first_click_total_lifetime_value_365d_local_currency,
      sum(first_order_first_click_total_lifetime_value_365d_global_currency) first_order_first_click_total_lifetime_value_365d_global_currency,
      sum(first_order_first_non_direct_click_total_lifetime_value_365d_local_currency) first_order_first_non_direct_click_total_lifetime_value_365d_local_currency,
      sum(first_order_first_non_direct_click_total_lifetime_value_365d_global_currency) first_order_first_non_direct_click_total_lifetime_value_365d_global_currency,
      sum(first_order_last_click_total_lifetime_value_365d_local_currency) first_order_last_click_total_lifetime_value_365d_local_currency,
      sum(first_order_last_click_total_lifetime_value_365d_global_currency) first_order_last_click_total_lifetime_value_365d_global_currency,
      sum(first_order_last_non_direct_click_total_lifetime_value_365d_local_currency) first_order_last_non_direct_click_total_lifetime_value_365d_local_currency,
      sum(first_order_last_non_direct_click_total_lifetime_value_365d_global_currency) first_order_last_non_direct_click_total_lifetime_value_365d_global_currency,
      sum(first_order_last_paid_click_total_lifetime_value_365d_local_currency) first_order_last_paid_click_total_lifetime_value_365d_local_currency,
      sum(first_order_last_paid_click_total_lifetime_value_365d_global_currency) first_order_last_paid_click_total_lifetime_value_365d_global_currency,
      sum(first_order_even_click_total_lifetime_value_365d_local_currency) first_order_even_click_total_lifetime_value_365d_local_currency,
      sum(first_order_even_click_total_lifetime_value_365d_global_currency) first_order_even_click_total_lifetime_value_365d_global_currency,
      sum(first_order_time_decay_total_lifetime_value_365d_local_currency) first_order_time_decay_total_lifetime_value_365d_local_currency,
      sum(first_order_time_decay_total_lifetime_value_365d_global_currency) first_order_time_decay_total_lifetime_value_365d_global_currency,
      sum(repeat_order_first_click_attrib_conversions) repeat_order_first_click_attrib_conversions,
      sum(repeat_order_first_non_direct_click_attrib_conversions) repeat_order_first_non_direct_click_attrib_conversions,
      sum(repeat_order_first_paid_click_attrib_conversions) repeat_order_first_paid_click_attrib_conversions,
      sum(repeat_order_last_click_attrib_conversions) repeat_order_last_click_attrib_conversions,
      sum(repeat_order_last_non_direct_click_attrib_conversions) repeat_order_last_non_direct_click_attrib_conversions,
      sum(repeat_order_last_paid_click_attrib_conversions) repeat_order_last_paid_click_attrib_conversions,
      sum(repeat_order_even_click_attrib_conversions) repeat_order_even_click_attrib_conversions,
      sum(repeat_order_time_decay_attrib_conversions) repeat_order_time_decay_attrib_conversions,
      sum(repeat_order_first_click_attrib_revenue_local_currency) repeat_order_first_click_attrib_revenue_local_currency,
      sum(repeat_order_first_click_attrib_revenue_global_currency) repeat_order_first_click_attrib_revenue_global_currency,
      sum(repeat_order_first_non_direct_click_attrib_revenue_local_currency) repeat_order_first_non_direct_click_attrib_revenue_local_currency,
      sum(repeat_order_first_non_direct_click_attrib_revenue_global_currency) repeat_order_first_non_direct_click_attrib_revenue_global_currency,
      sum(repeat_order_first_paid_click_attrib_revenue_local_currency) repeat_order_first_paid_click_attrib_revenue_local_currency,
      sum(repeat_order_first_paid_click_attrib_revenue_global_currency) repeat_order_first_paid_click_attrib_revenue_global_currency,
      sum(repeat_order_last_click_attrib_revenue_local_currency) repeat_order_last_click_attrib_revenue_local_currency,
      sum(repeat_order_last_click_attrib_revenue_global_currency) repeat_order_last_click_attrib_revenue_global_currency,
      sum(repeat_order_last_non_direct_click_attrib_revenue_local_currency) repeat_order_last_non_direct_click_attrib_revenue_local_currency,
      sum(repeat_order_last_non_direct_click_attrib_revenue_global_currency) repeat_order_last_non_direct_click_attrib_revenue_global_currency,
      sum(repeat_order_last_paid_click_attrib_revenue_local_currency) repeat_order_last_paid_click_attrib_revenue_local_currency,
      sum(repeat_order_last_paid_click_attrib_revenue_global_currency) repeat_order_last_paid_click_attrib_revenue_global_currency,
      sum(repeat_order_even_click_attrib_revenue_local_currency) repeat_order_even_click_attrib_revenue_local_currency,
      sum(repeat_order_even_click_attrib_revenue_global_currency) repeat_order_even_click_attrib_revenue_global_currency,
      sum(repeat_order_time_decay_attrib_revenue_local_currency) repeat_order_time_decay_attrib_revenue_local_currency,
      sum(repeat_order_time_decay_attrib_revenue_global_currency) repeat_order_time_decay_attrib_revenue_global_currency
    from
      {{ ref('wh_attribution_fact') }}
    {{ dbt_utils.group_by(4) }}
  )
select
    a.campaign_ts ,
    a.platform ,
    a.campaign_id ,
    a.campaign_name,
    a.ad_group_id ,
    a.ad_group_name,
    a.reported_clicks ,
    a.reported_impressions ,
    a.reported_spend_local_currency,
    a.reported_spend_global_currency,
    a.reported_cpc_local_currency,
    a.reported_cpc_global_currency,
    a.reported_ctr ,
    a.actual_clicks ,
    a.actual_cpc_local_currency,
    a.actual_cpc_global_currency,
    a.actual_ctr ,
    r.user_registration_first_click_attrib_conversions,
    r.user_registration_first_non_direct_click_attrib_conversions,
    r.user_registration_first_paid_click_attrib_conversions,
    r.user_registration_last_click_attrib_conversions,
    r.user_registration_last_non_direct_click_attrib_conversions,
    r.user_registration_last_paid_click_attrib_conversions,
    r.user_registration_even_click_attrib_conversions,
    r.user_registration_time_decay_attrib_conversions,
    r.first_order_first_click_attrib_conversions,
    r.first_order_first_non_direct_click_attrib_conversions,
    r.first_order_first_paid_click_attrib_conversions,
    r.first_order_last_click_attrib_conversions,
    r.first_order_last_non_direct_click_attrib_conversions,
    r.first_order_last_paid_click_attrib_conversions,
    r.first_order_even_click_attrib_conversions,
    r.first_order_time_decay_attrib_conversions,
    r.first_order_first_click_attrib_revenue_local_currency,
    r.first_order_first_click_attrib_revenue_global_currency,
    r.first_order_first_non_direct_click_attrib_revenue_local_currency,
    r.first_order_first_non_direct_click_attrib_revenue_global_currency,
    r.first_order_first_paid_click_attrib_revenue_local_currency,
    r.first_order_first_paid_click_attrib_revenue_global_currency,
    r.first_order_last_click_attrib_revenue_local_currency,
    r.first_order_last_click_attrib_revenue_global_currency,
    r.first_order_last_non_direct_click_attrib_revenue_local_currency,
    r.first_order_last_non_direct_click_attrib_revenue_global_currency,
    r.first_order_last_paid_click_attrib_revenue_local_currency,
    r.first_order_last_paid_click_attrib_revenue_global_currency,
    r.first_order_even_click_attrib_revenue_local_currency,
    r.first_order_even_click_attrib_revenue_global_currency,
    r.first_order_time_decay_attrib_revenue_local_currency,
    r.first_order_time_decay_attrib_revenue_global_currency,
    r.first_order_first_click_total_lifetime_value_30d_local_currency,
    r.first_order_first_click_total_lifetime_value_30d_global_currency,
    r.first_order_first_non_direct_click_total_lifetime_value_30d_local_currency,
    r.first_order_first_non_direct_click_total_lifetime_value_30d_global_currency,
    r.first_order_last_click_total_lifetime_value_30d_local_currency,
    r.first_order_last_click_total_lifetime_value_30d_global_currency,
    r.first_order_last_non_direct_click_total_lifetime_value_30d_local_currency,
    r.first_order_last_non_direct_click_total_lifetime_value_30d_global_currency,
    r.first_order_last_paid_click_total_lifetime_value_30d_local_currency,
    r.first_order_last_paid_click_total_lifetime_value_30d_global_currency,
    r.first_order_even_click_total_lifetime_value_30d_local_currency,
    r.first_order_even_click_total_lifetime_value_30d_global_currency,
    r.first_order_time_decay_total_lifetime_value_30d_local_currency,
    r.first_order_time_decay_total_lifetime_value_30d_global_currency,
    r.first_order_first_click_total_lifetime_value_60d_local_currency,
    r.first_order_first_click_total_lifetime_value_60d_global_currency,
    r.first_order_first_non_direct_click_total_lifetime_value_60d_local_currency,
    r.first_order_first_non_direct_click_total_lifetime_value_60d_global_currency,
    r.first_order_last_click_total_lifetime_value_60d_local_currency,
    r.first_order_last_click_total_lifetime_value_60d_global_currency,
    r.first_order_last_non_direct_click_total_lifetime_value_60d_local_currency,
    r.first_order_last_non_direct_click_total_lifetime_value_60d_global_currency,
    r.first_order_last_paid_click_total_lifetime_value_60d_local_currency,
    r.first_order_last_paid_click_total_lifetime_value_60d_global_currency,
    r.first_order_even_click_total_lifetime_value_60d_local_currency,
    r.first_order_even_click_total_lifetime_value_60d_global_currency,
    r.first_order_time_decay_total_lifetime_value_60d_local_currency,
    r.first_order_time_decay_total_lifetime_value_60d_global_currency,
    r.first_order_first_click_total_lifetime_value_90d_local_currency,
    r.first_order_first_click_total_lifetime_value_90d_global_currency,
    r.first_order_first_non_direct_click_total_lifetime_value_90d_local_currency,
    r.first_order_first_non_direct_click_total_lifetime_value_90d_global_currency,
    r.first_order_last_click_total_lifetime_value_90d_local_currency,
    r.first_order_last_click_total_lifetime_value_90d_global_currency,
    r.first_order_last_non_direct_click_total_lifetime_value_90d_local_currency,
    r.first_order_last_non_direct_click_total_lifetime_value_90d_global_currency,
    r.first_order_last_paid_click_total_lifetime_value_90d_local_currency,
    r.first_order_last_paid_click_total_lifetime_value_90d_global_currency,
    r.first_order_even_click_total_lifetime_value_90d_local_currency,
    r.first_order_even_click_total_lifetime_value_90d_global_currency,
    r.first_order_time_decay_total_lifetime_value_90d_local_currency,
    r.first_order_time_decay_total_lifetime_value_90d_global_currency,
    r.first_order_first_click_total_lifetime_value_180d_local_currency,
    r.first_order_first_click_total_lifetime_value_180d_global_currency,
    r.first_order_first_non_direct_click_total_lifetime_value_180d_local_currency,
    r.first_order_first_non_direct_click_total_lifetime_value_180d_global_currency,
    r.first_order_last_click_total_lifetime_value_180d_local_currency,
    r.first_order_last_click_total_lifetime_value_180d_global_currency,
    r.first_order_last_non_direct_click_total_lifetime_value_180d_local_currency,
    r.first_order_last_non_direct_click_total_lifetime_value_180d_global_currency,
    r.first_order_last_paid_click_total_lifetime_value_180d_local_currency,
    r.first_order_last_paid_click_total_lifetime_value_180d_global_currency,
    r.first_order_even_click_total_lifetime_value_180d_local_currency,
    r.first_order_even_click_total_lifetime_value_180d_global_currency,
    r.first_order_time_decay_total_lifetime_value_180d_local_currency,
    r.first_order_time_decay_total_lifetime_value_180d_global_currency,
    r.first_order_first_click_total_lifetime_value_365d_local_currency,
    r.first_order_first_click_total_lifetime_value_365d_global_currency,
    r.first_order_first_non_direct_click_total_lifetime_value_365d_local_currency,
    r.first_order_first_non_direct_click_total_lifetime_value_365d_global_currency,
    r.first_order_last_click_total_lifetime_value_365d_local_currency,
    r.first_order_last_click_total_lifetime_value_365d_global_currency,
    r.first_order_last_non_direct_click_total_lifetime_value_365d_local_currency,
    r.first_order_last_non_direct_click_total_lifetime_value_365d_global_currency,
    r.first_order_last_paid_click_total_lifetime_value_365d_local_currency,
    r.first_order_last_paid_click_total_lifetime_value_365d_global_currency,
    r.first_order_even_click_total_lifetime_value_365d_local_currency,
    r.first_order_even_click_total_lifetime_value_365d_global_currency,
    r.first_order_time_decay_total_lifetime_value_365d_local_currency,
    r.first_order_time_decay_total_lifetime_value_365d_global_currency,
    r.repeat_order_first_click_attrib_conversions,
    r.repeat_order_first_non_direct_click_attrib_conversions,
    r.repeat_order_first_paid_click_attrib_conversions,
    r.repeat_order_last_click_attrib_conversions,
    r.repeat_order_last_non_direct_click_attrib_conversions,
    r.repeat_order_last_paid_click_attrib_conversions,
    r.repeat_order_even_click_attrib_conversions,
    r.repeat_order_time_decay_attrib_conversions,
    r.repeat_order_first_click_attrib_revenue_local_currency,
    r.repeat_order_first_click_attrib_revenue_global_currency,
    r.repeat_order_first_non_direct_click_attrib_revenue_local_currency,
    r.repeat_order_first_non_direct_click_attrib_revenue_global_currency,
    r.repeat_order_first_paid_click_attrib_revenue_local_currency,
    r.repeat_order_first_paid_click_attrib_revenue_global_currency,
    r.repeat_order_last_click_attrib_revenue_local_currency,
    r.repeat_order_last_click_attrib_revenue_global_currency,
    r.repeat_order_last_non_direct_click_attrib_revenue_local_currency,
    r.repeat_order_last_non_direct_click_attrib_revenue_global_currency,
    r.repeat_order_last_paid_click_attrib_revenue_local_currency,
    r.repeat_order_last_paid_click_attrib_revenue_global_currency,
    r.repeat_order_even_click_attrib_revenue_local_currency,
    r.repeat_order_even_click_attrib_revenue_global_currency,
    r.repeat_order_time_decay_attrib_revenue_local_currency,
    r.repeat_order_time_decay_attrib_revenue_global_currency
from
  ad_campaign_stats a
left join
  revenue_attribution r
on
  a.campaign_ts = r.converted_ts
and
  a.campaign_id = r.campaign_id
and
  a.ad_group_id = r.ad_group_id
and
  a.platform = r.platform

  {% endif %}
  {% endif %}
