version: 2

models:

  - name: wh_ad_campaign_performance_fact
    meta:
      label: "Campaign Performance"
    columns:
      - name: ad_campaign_performance_pk
        meta:
          dimension:
            label: "Ad Campaign Performance Key"
            type: string
            hidden: no
      - name: platform
        meta:
          dimension:
            label: "Ad Platform"
            type: string
            hidden: no
      - name: account_id
        meta:
          dimension:
            label: "Account ID"
            type: string
            hidden: no
      - name: account_name
        meta:
          dimension:
            label: "Account Name"
            type: string
            hidden: no
      - name: local_currency
        meta:
          dimension:
            label: "Local Currency"
            type: string
            hidden: no
      - name: campaign_id
        meta:
          dimension:
            label: "Campaign ID"
            type: string
            hidden: no
      - name: campaign_name
        meta:
          dimension:
            label: "Campaign Name"
            type: string
      - name: campaign_ts
        meta:
          dimension:
            label: "Campaign Date"
            type: timestamp
            time_intervals: default
      - name: ad_group_id
        meta:
          dimension:
            label: "Ad Group ID"
            type: string
      - name: ad_group_name
        meta:
          dimension:
            label: "Ad Group Name"
            type: string
      - name: total_clicks
        meta:
          dimension:
            label: "Total Clicks"
            type: number
            hidden: yes
          metrics:
            total_clicks:
              type: sum
              label: "Total Clicks"
      - name: total_reported_clicks
        meta:
          dimension:
            label: "Total Reported Clicks"
            type: number
            hidden: yes
          metrics:
            total_reported_clicks:
              type: sum
              label: "Total Reported Clicks"
      - name: total_reported_impressions
        meta:
          dimension:
            label: "Total Reported Impressions"
            type: number
            hidden: yes
          metrics:
            total_reported_impressions:
              type: sum
              label: "Total Reported Impressions"
      - name: actual_vs_reported_clicks_pct
        meta:
          dimension:
            label: "Actual Vs Reported Clicks Pct"
            type: number
            hidden: yes
          metrics:
            avg_actual_vs_reported_clicks_pct:
              type: average
              label: "Average Actual Vs Reported Clicks Pct"
      - name: reported_spend_local_currency
        meta:
          dimension:
            label: "Total Reported Spend Local Currency"
            type: number
            hidden: yes
          metrics:
            total_total_reported_cost_local:
              type: sum
              label: "Total Spend Local Currency"
      - name: reported_spend_global_currency
        meta:
          dimension:
            label: "Total Reported Spend Local Currency"
            type: number
            hidden: yes
          metrics:
            total_total_reported_cost_global:
              type: sum
              label: "Total Spend"
      - name: reported_cpc_global_currency
        meta:
          dimension:
            label: "Reported CPC Global Currency"
            type: number
            hidden: yes
          metrics:
            avg_reported_cpc:
              type: average
              label: "Average Reported CPC"
      - name: reported_cpc_local_currency
        meta:
          dimension:
            label: "Reported Cpc Local Currency"
            type: number
            hidden: yes
          metrics:
            avg_reported_cpc:
              type: average
              label: "Average Reported Cpc Local Currency"
      - name: reported_ctr
        meta:
          dimension:
            label: "Reported Ctr"
            type: number
            hidden: yes
          metrics:
            avg_reported_ctr:
              type: average
              label: "Average Reported Ctr"



  - name: wh_ad_spend_roi_fact
    meta:
      label: "Ad Spend & Revenue Attribution"
    columns:
      - name: campaign_ts
        meta:
          dimension:
            label: "Campaign Ts"
            type: timestamp
            time_intervals: default
      - name: platform
        meta:
          dimension:
            label: "Ad Platform"
            type: string
            hidden: no
      - name: campaign_id
        meta:
          dimension:
            label: "Campaign ID"
            type: string
            hidden: no
      - name: campaign_name
        meta:
          dimension:
            label: "Campaign Name"
            type: string
            hidden: no
      - name: ad_group_id
        meta:
          dimension:
            label: "Ad Group ID"
            type: string
            hidden: no
      - name: ad_group_name
        meta:
          dimension:
            label: "Ad Group Name"
            type: string
            hidden: no
      - name: account_id
        meta:
          dimension:
            label: "Account ID"
            type: string
            hidden: no
      - name: account_name
        meta:
          dimension:
            label: "Account Name"
            type: string
            hidden: no
      - name: count_repeat_order_conversions
        description: Total count of repeat order conversion events within the session.
        meta:
          dimension:
            label: "Total Repeat Orders"
            type: number
            hidden: yes
          metrics:
            total_repeat_orders:
              type: sum
              label: "Repeat Orders"
      - name: count_first_order_conversions
        description: Total count of first order conversion events within the session.
        meta:
          dimension:
            label: "Total First Orders"
            type: number
            hidden: yes
          metrics:
            total_first_orders:
              type: sum
              label: "First Orders"
      - name: count_registration_conversions
        description: Total count of account opening conversion events within the session.
        meta:
          dimension:
            label: "Total User Registrations"
            type: number
            hidden: yes
          metrics:
            total_user_registrations:
              type: sum
              label: "User Registrations"
      - name: user_registration_first_click_attrib_conversions
        description: Number of account opening conversions using the First Click Decay attribution model.
        meta:
          dimension:
            label: "Total First Click User Registrations"
            type: number
            hidden: yes
          metrics:
            total_first_click_user_registrations:
              type: sum
              label: "First Click User Registrations"
      - name: user_registration_first_non_direct_click_attrib_conversions
        description: Number of account opening conversions using the First Non-Direct Click attribution model.
        meta:
          dimension:
            label: "Total First Non-Direct Click User Registrations"
            type: number
            hidden: yes
          metrics:
            total_first_non_direct_click_user_registrations:
              type: sum
              label: "First Non-Direct Click User Registrations"
      - name: user_registration_last_click_attrib_conversions
        description: Number of account opening conversions using the Last Click attribution model.
        meta:
          dimension:
            label: "Total Last Click User Registrations"
            type: number
            hidden: yes
          metrics:
            total_last_click_user_registrations:
              type: sum
              label: "Last Click User Registrations"
      - name: user_registration_last_non_direct_click_attrib_conversions
        description: Number of account opening conversions using the Last Non-Direct Click attribution model.
        meta:
          dimension:
            label: "Total Last Non-Direct Click User Registrations"
            type: number
            hidden: yes
          metrics:
            total_last_non_direct_click_user_registrations:
              type: sum
              label: "Last Non-Direct Click User Registrations"
      - name: user_registration_last_paid_click_attrib_conversions
        description: Number of account opening conversions using the Last Paid Click attribution model.
        meta:
          dimension:
            label: "Last Paid Click User Registrations"
            type: number
            hidden: yes
          metrics:
            total_last_paid_click_user_registrations:
              type: sum
              label: "Last Paid Click User Registrations"
      - name: user_registration_even_click_attrib_conversions
        description: Number of account opening conversions using the Even Click attribution model.
        meta:
          dimension:
            label: "Even Click User Registrations"
            type: number
            hidden: yes
          metrics:
            total_even_click_user_registrations:
              type: sum
              label: "Even Click User Registrations"
      - name: user_registration_time_decay_attrib_conversions
        description: Number of account opening conversions using the Time Decay attribution model.
        meta:
          dimension:
            label: "Total Time Decay User Registrations"
            type: number
            hidden: yes
          metrics:
            total_time_decay_user_registrations:
              type: sum
              label: "Time Decay User Registrations"
      - name: first_order_first_click_attrib_conversions
        description: Number of first order conversions using the First Click attribution model.
        meta:
          dimension:
            label: "Total First Click First Orders"
            type: number
            hidden: yes
          metrics:
            total_first_click_orders:
              type: sum
              label: "First Click First Orders"
      - name: first_order_first_non_direct_click_attrib_conversions
        description: Number of first order conversions using the First Non-Direct Click attribution model.
        meta:
          dimension:
            label: "Total First Non-Direct Click First Orders"
            type: number
            hidden: yes
          metrics:
            total_first_click_orders:
              type: sum
              label: "First Non-Direct Click First Orders"
      - name: first_order_first_paid_click_attrib_conversions
        description: Number of first order conversions using the First Paid Click attribution model.
        meta:
          dimension:
            label: "Total First Paid Click First Orders"
            type: number
            hidden: yes
          metrics:
            total_first_paid_click_orders:
              type: sum
              label: "First Paid Click First Orders"
      - name: first_order_last_click_attrib_conversions
        description: Number of first order conversions using the Last Click attribution model.
        meta:
          dimension:
            label: "Total Last Click Orders"
            type: number
            hidden: yes
          metrics:
            total_last_click_orders:
              type: sum
              label: "Last Click First Orders"
      - name: first_order_last_non_direct_click_attrib_conversions
        description: Number of first order conversions using the Last Non-Direct Click attribution model.
        meta:
          dimension:
            label: "Total Last Non-Direct Click First Orders"
            type: number
            hidden: yes
          metrics:
            total_last_non_direct_click_orders:
              type: sum
              label: "Last Non-Direct Click First Orders"
      - name: first_order_even_click_attrib_conversions
        description: Number of first order conversions using the Even Click attribution model.
        meta:
          dimension:
            label: "Total Even Click First Orders"
            type: number
            hidden: yes
          metrics:
            total_even_click_orders:
              type: sum
              label: "Last Even Click First Orders"
      - name: first_order_first_click_attrib_revenue
        meta:
          dimension:
            label: "Total First Click First Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_first_click_order_revenue:
              type: sum
              label: "First Click First Order Revenue"
      - name: first_order_first_non_direct_click_attrib_revenue
        meta:
          dimension:
            label: "Total First Non-Direct Click First Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_first_non_direct_click_order_revenue:
              type: sum
              label: "First Non-Direct Click First Order Revenue"
      - name: first_order_first_paid_click_attrib_revenue
        meta:
          dimension:
            label: "Total First Paid Click First Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_first_paid_click_first_order_revenue:
              type: sum
              label: "First Paid Click First Order Revenue"
      - name: first_order_last_click_attrib_revenue
        meta:
          dimension:
            label: "Total Last Click First Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_last_click_first_order_revenue:
              type: sum
              label: "Last Last Click First Order Revenue"
      - name: first_order_last_non_direct_click_attrib_revenue
        meta:
          dimension:
            label: "Total Last Non-Direct Click First Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_last_non_direct_click_first_order_revenue:
              type: sum
              label: "Last Non-Direct Click First Order Revenue"
      - name: first_order_last_paid_click_attrib_revenue
        meta:
          dimension:
            label: "Total Last Paid Click First Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_last_paid_click_first_order_revenue:
              type: sum
              label: "Last Paid Click First Order Revenue"
      - name: first_order_even_click_attrib_revenue
        meta:
          dimension:
            label: "Total Even Click First Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_even_click_first_order_revenue:
              type: sum
              label: "Even Click First Order Revenue"
      - name: repeat_order_first_click_attrib_conversions
        meta:
          dimension:
            label: "Total First Click Repeat Orders"
            type: number
            hidden: yes
          metrics:
            total_first_click_repeat_orders:
              type: sum
              label: "First Click Repeat Orders"
      - name: repeat_order_first_non_direct_click_attrib_conversions
        meta:
          dimension:
            label: "Total First Non-Direct Click Repeat Orders"
            type: number
            hidden: yes
          metrics:
            total_first_non_direct_click_repeat_orders:
              type: sum
              label: "First Non-Direct Click Repeat Orders"
      - name: repeat_order_last_click_attrib_conversions
        meta:
          dimension:
            label: "Total Last Click Repeat Orders"
            type: number
            hidden: yes
          metrics:
            total_last_click_repeat_orders:
              type: sum
              label: "Last Click Repeat Orders"
      - name: repeat_order_last_non_direct_click_attrib_conversions
        meta:
          dimension:
            label: "Total Last Non-Direct Click Repeat Orders"
            type: number
            hidden: yes
          metrics:
            total_last_non_direct_click_repeat_orders:
              type: sum
              label: "Last Non-Direct Click Repeat Orders"
      - name: repeat_order_last_paid_click_attrib_conversions
        meta:
          dimension:
            label: "Total Last Paid Click Repeat Orders"
            type: number
            hidden: yes
          metrics:
            total_last_paid_click_repeat_orders:
              type: sum
              label: "Last Non Paid Click Repeat Orders"
      - name: repeat_order_even_click_attrib_conversions
        meta:
          dimension:
            label: "Total Even Click Repeat Orders"
            type: number
            hidden: yes
          metrics:
            total_even_click_repeat_orders:
              type: sum
              label: "Last Non Paid Click Repeat Orders"
      - name: repeat_order_time_decay_attrib_conversions
        meta:
          dimension:
            label: "Total Time Decay Repeat Orders"
            type: number
            hidden: yes
          metrics:
            total_time_decay_repeat_orders:
              type: sum
              label: "Time Decay Repeat Orders"
      - name: repeat_order_first_click_attrib_revenue
        meta:
          dimension:
            label: "Total First Click Repeat Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_first_click_repeat_order_revenue:
              type: sum
              label: "First Click Repeat Order Revenue"
      - name: repeat_order_first_non_direct_click_attrib_revenue
        meta:
          dimension:
            label: "Total First Non-Direct Repeat Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_first_non_direct_click_repeat_order_revenue:
              type: sum
              label: "First Non-Direct Click Repeat Order Revenue"
      - name: repeat_order_first_paid_click_attrib_revenue
        meta:
          dimension:
            label: "Total First Paid Click Repeat Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_first_paid_click_repeat_order_revenue:
              type: sum
              label: "First Paid Click Repeat Order Revenue"
      - name: repeat_order_last_click_attrib_revenue
        meta:
          dimension:
            label: "Total Last Click Repeat Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_last_click_repeat_order_revenue:
              type: sum
              label: "Last Click Repeat Order Revenue"
      - name: repeat_order_last_non_direct_click_attrib_revenue
        meta:
          dimension:
            label: "Total Last Non-Direct Click Repeat Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_last_non_direct_click_repeat_order_revenue:
              type: sum
              label: "Last Non-Direct Click Repeat Order Revenue"
      - name: repeat_order_last_paid_click_attrib_revenue
        meta:
          dimension:
            label: "Total Last Paid Click Repeat Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_last_paid_click_repeat_order_revenue:
              type: sum
              label: "Last Paid Click Repeat Order Revenue"
      - name: repeat_order_even_click_attrib_revenue
        meta:
          dimension:
            label: "Total Even Click Repeat Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_even_click_repeat_order_revenue:
              type: sum
              label: "Even Click Repeat Order Revenue"
      - name: repeat_order_time_decay_attrib_revenue
        meta:
          dimension:
            label: "Total Time Decay Repeat Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_time_decay_repeat_order_revenue:
              type: sum
              label: "Time Decay Repeat Order Revenue"

  - name: wh_ad_campaign_performance_fact
    meta:
      label: "Ad Campaign Performance"
    columns:
      - name: ad_campaign_performance_pk
        meta:
          dimension:
            label: "Ad Campaign Performance Key"
            type: string
            hidden: no
      - name: platform
        meta:
          dimension:
            label: "Ad Platform"
            type: string
            hidden: no
      - name: account_id
        meta:
          dimension:
            label: "Account ID"
            type: string
            hidden: no
      - name: account_name
        meta:
          dimension:
            label: "Account Name"
            type: string
            hidden: no
      - name: local_currency
        meta:
          dimension:
            label: "Local Currency"
            type: string
            hidden: no
      - name: campaign_id
        meta:
          dimension:
            label: "Campaign ID"
            type: string
            hidden: no
      - name: campaign_name
        meta:
          dimension:
            label: "Campaign Name"
            type: string
      - name: campaign_ts
        meta:
          dimension:
            label: "Campaign Date"
            type: timestamp
            time_intervals: default
      - name: ad_group_id
        meta:
          dimension:
            label: "Ad Group ID"
            type: string
      - name: ad_group_name
        meta:
          dimension:
            label: "Ad Group Name"
            type: string
      - name: total_clicks
        meta:
          dimension:
            label: "Total Clicks"
            type: number
            hidden: yes
          metrics:
            total_clicks:
              type: sum
              label: "Total Clicks"
      - name: total_reported_clicks
        meta:
          dimension:
            label: "Total Reported Clicks"
            type: number
            hidden: yes
          metrics:
            total_reported_clicks:
              type: sum
              label: "Total Reported Clicks"
      - name: total_reported_impressions
        meta:
          dimension:
            label: "Total Reported Impressions"
            type: number
            hidden: yes
          metrics:
            total_reported_impressions:
              type: sum
              label: "Total Reported Impressions"
      - name: actual_vs_reported_clicks_pct
        meta:
          dimension:
            label: "Actual Vs Reported Clicks Pct"
            type: number
            hidden: yes
          metrics:
            avg_actual_vs_reported_clicks_pct:
              type: average
              label: "Average Actual Vs Reported Clicks Pct"
      - name: reported_spend_local_currency
        meta:
          dimension:
            label: "Total Reported Spend Local Currency"
            type: number
            hidden: yes
          metrics:
            total_total_reported_cost_local:
              type: sum
              label: "Total Spend Local Currency"
      - name: reported_spend_global_currency
        meta:
          dimension:
            label: "Total Reported Spend Local Currency"
            type: number
            hidden: yes
          metrics:
            total_total_reported_cost_global:
              type: sum
              label: "Total Spend"
      - name: reported_cpc_global_currency
        meta:
          dimension:
            label: "Reported CPC Global Currency"
            type: number
            hidden: yes
          metrics:
            avg_reported_cpc:
              type: average
              label: "Average Reported CPC"
      - name: reported_cpc_local_currency
        meta:
          dimension:
            label: "Reported Cpc Local Currency"
            type: number
            hidden: yes
          metrics:
            avg_reported_cpc:
              type: average
              label: "Average Reported Cpc Local Currency"
      - name: reported_ctr
        meta:
          dimension:
            label: "Reported Ctr"
            type: number
            hidden: yes
          metrics:
            avg_reported_ctr:
              type: average
              label: "Average Reported Ctr"


  - name: wh_web_events_fact
    meta:
      label: "Events"
      join:
        sql_on: ${wh_web_events_fact.web_sessions_pk} = ${wh_web_sessions_fact.web_sessions_pk}
    columns:
      - name: event_ts
        meta:
          dimension:
            label: "Event"
            type: timestamp
            time_intervals: default
      - name: web_event_pk
        meta:
          dimension:
            label: "Web Event Key"
            type: string
            hidden: no
          metrics:
            total_events:
              type: count_distinct
              label: "Count of Events"
      - name: event_id
        meta:
          dimension:
            label: "Event Id"
            type: string
            hidden: yes
      - name: event_type
        meta:
          dimension:
            label: "Event Type"
            type: string
            hidden: no
      - name: event_details
        meta:
          dimension:
            label: "Event Details"
            type: string
            hidden: no
      - name: page_title
        meta:
          dimension:
            label: "Page Title"
            type: string
            hidden: no
      - name: page_url_path
        meta:
          dimension:
            label: "Page Url Path"
            type: string
            hidden: no
      - name: referrer_host
        meta:
          dimension:
            label: "Referrer Host"
            type: string
            hidden: no
      - name: search
        meta:
          dimension:
            label: "Search"
            type: string
            hidden: no
      - name: page_url
        meta:
          dimension:
            label: "Page Url"
            type: string
            hidden: no
      - name: page_url_host
        meta:
          dimension:
            label: "Page Url Host"
            type: string
            hidden: no
      - name: gclid
        meta:
          dimension:
            label: "Gclid"
            type: string
            hidden: no
      - name: utm_term
        meta:
          dimension:
            label: "Utm Term"
            type: string
            hidden: no
      - name: utm_content
        meta:
          dimension:
            label: "Utm Content"
            type: string
            hidden: no
      - name: utm_medium
        meta:
          dimension:
            label: "Utm Medium"
            type: string
            hidden: no
      - name: utm_campaign
        meta:
          dimension:
            label: "Utm Campaign"
            type: string
            hidden: no
      - name: utm_source
        meta:
          dimension:
            label: "Utm Source"
            type: string
            hidden: no
      - name: ip
        meta:
          dimension:
            label: "Ip"
            type: string
            hidden: no
      - name: visitor_id
        meta:
          dimension:
            label: "Visitor Id"
            type: string
            hidden: no
      - name: user_id
        meta:
          dimension:
            label: "User Id"
            type: string
            hidden: no
      - name: device
        meta:
          dimension:
            label: "Device"
            type: string
            hidden: no
      - name: device_category
        meta:
          dimension:
            label: "Device Category"
            type: string
            hidden: no
      - name: site
        meta:
          dimension:
            label: "Site"
            type: string
            hidden: no
      - name: blended_user_id
        meta:
          dimension:
            label: "Blended User Id"
            type: string
            hidden: no
      - name: web_sessions_pk
        meta:
          dimension:
            label: "Web Sessions Key"
            type: string
            hidden: no

      - name: event_seq
        meta:
          dimension:
            label: "Event Seq"
            type: number
            hidden: no
      - name: event_in_session_seq
        meta:
          dimension:
            label: "Session Event Order"
            type: number
            hidden: no
      - name: event_seq
        meta:
          dimension:
            label: "Session Order"
            type: number
            hidden: no
      - name: time_on_page_secs
        meta:
          dimension:
            label: "Time On Page Secs"
            type: number
            hidden: yes
          metrics:
            total_time_on_page_secs:
              type: sum
              label: "Total Time On Page Secs"
            avg_time_on_page_secs:
              type: average
              label: "Average Time On Page Secs"

  - name: wh_web_sessions_fact
    meta:
      label: "Sessions"
      join:
        sql_on: ${wh_web_sessions_fact.web_sessions_pk} = ${wh_web_events_fact.web_sessions_pk}
    columns:
    - name: session_end_ts
      meta:
        dimension:
          label: "Session End"
          type: timestamp
          time_intervals: default
    - name: session_start_ts
      meta:
        dimension:
          label: "Session Start"
          type: timestamp
          time_intervals: default
    - name: is_bounced_session
      meta:
        dimension:
          label: "Is Bounced Session"
          type: boolean
          hidden: no
    - name: is_click_id_matched
      meta:
        dimension:
          label: "Is Click Id Matched"
          type: boolean
          hidden: no
    - name: events
      meta:
        dimension:
          label: "Events"
          type: number
          hidden: no
    - name: duration_in_s
      meta:
        dimension:
          label: "Duration In S"
          type: number
          hidden: no
    - name: mins_between_sessions
      meta:
        dimension:
          label: "Mins Between Sessions"
          type: number
          hidden: yes
        metrics:
          total_mins_between_sessions:
            type: sum
            label: "Total Mins Between Sessions"
    - name: web_sessions_pk
      meta:
        dimension:
          label: "Web Sessions Key"
          type: string
          hidden: no
    - name: utm_source
      meta:
        dimension:
          label: "Utm Source"
          type: string
          hidden: no
    - name: utm_content
      meta:
        dimension:
          label: "Utm Content"
          type: string
          hidden: no
    - name: utm_medium
      meta:
        dimension:
          label: "Utm Medium"
          type: string
          hidden: no
    - name: utm_campaign
      meta:
        dimension:
          label: "Utm Campaign"
          type: string
          hidden: no
    - name: utm_term
      meta:
        dimension:
          label: "Utm Term"
          type: string
          hidden: no
    - name: search
      meta:
        dimension:
          label: "Search"
          type: string
          hidden: no
    - name: gclid
      meta:
        dimension:
          label: "Gclid"
          type: string
          hidden: no
    - name: first_page_url
      meta:
        dimension:
          label: "First Page Url"
          type: string
          hidden: no
    - name: first_page_url_host
      meta:
        dimension:
          label: "First Page Url Host"
          type: string
          hidden: no
    - name: first_page_url_path
      meta:
        dimension:
          label: "First Page Url Path"
          type: string
          hidden: no
    - name: referrer_host
      meta:
        dimension:
          label: "Referrer Host"
          type: string
          hidden: no
    - name: device
      meta:
        dimension:
          label: "Device"
          type: string
          hidden: no
    - name: device_category
      meta:
        dimension:
          label: "Device Category"
          type: string
          hidden: no
    - name: last_page_url
      meta:
        dimension:
          label: "Last Page Url"
          type: string
          hidden: no
    - name: last_page_url_host
      meta:
        dimension:
          label: "Last Page Url Host"
          type: string
          hidden: no
    - name: last_page_url_path
      meta:
        dimension:
          label: "Last Page Url Path"
          type: string
          hidden: no
    - name: referrer_medium
      meta:
        dimension:
          label: "Referrer Medium"
          type: string
          hidden: no
    - name: referrer_source
      meta:
        dimension:
          label: "Referrer Source"
          type: string
          hidden: no
    - name: channel
      meta:
        dimension:
          label: "Channel"
          type: string
          hidden: no
    - name: blended_user_id
      meta:
        dimension:
          label: "Blended User Id"
          type: string
          hidden: no
    - name: events
      meta:
        dimension:
          label: "Events"
          type: number
          hidden: yes
        metrics:
          total_events:
            type: sum
            label: "Total Events"
          avg_events:
            type: average
            label: "Average Events"
    - name: duration_in_s
      meta:
        dimension:
          label: "Duration In S"
          type: number
          hidden: yes
        metrics:
          total_duration_in_s:
            type: sum
            label: "Total Duration In S"
          avg_duration_in_s:
            type: average
            label: "Average Duration In S"


  - name: wh_attribution_fact
    meta:
      label: "Revenue Attribution"
      join:
        sql_on: ${wh_attribution_fact.web_sessions_pk} = ${wh_web_sessions_fact.web_sessions_pk}
    columns:
      - name: blended_user_id
        description: The custom user ID for each user, identity-stitched using the user's logged-in and unauthenticated sessions.
        meta:
          dimension:
            label: "User ID"
            type: number
            hidden: no
          metrics:
            total_blended_user_ids:
              type: count_distinct
              label: "Total Users"
      - name: session_start_ts
        meta:
          dimension:
            label: "Session Start"
            type: timestamp
            hidden: no
      - name: session_end_ts
        meta:
          dimension:
            label: "Session End"
            type: timestamp
            hidden: no
      - name: web_session_pk
        meta:
          dimension:
            label: "Session ID"
            type: timestamp
            hidden: no
          metrics:
            total_sessions:
              type: count_distinct
              label: "Total Sessions"
        description: Session ID either created by Snowplow or generated by this package for custom order/account opening sessions
      - name: session_seq
        meta:
          dimension:
            label: "Session Order"
            type: number
            hidden: no
        description: Sequence number of the user's sessions, starting at 1
      - name: conversion_session
        meta:
          dimension:
            label: "Is Conversion Session"
            type: boolean
            hidden: no
        description: Boolean value to indicate whether the session contained one or more conversion events
      - name: utm_source
        meta:
          dimension:
            label: "UTM Source"
            type: string
            hidden: no
      - name: utm_content
        meta:
          dimension:
            label: "UTM Content"
            type: string
            hidden: no
      - name: utm_medium
        meta:
          dimension:
            label: "UTM Medium"
            type: string
            hidden: no
      - name: utm_campaign
        meta:
          dimension:
            label: "UTM Campaign"
            type: string
            hidden: no
      - name: platform
        meta:
          dimension:
            label: "Ad Platform"
            type: string
            hidden: no
      - name: campaign_id
        meta:
          dimension:
            label: "Campaign ID"
            type: string
            hidden: no
      - name: ad_group_id
        meta:
          dimension:
            label: "Ad Group ID"
            type: string
            hidden: no
      - name: referrer_host
        meta:
          dimension:
            label: "Referrer Host"
            type: string
            hidden: no
      - name: referrer_domain
        meta:
          dimension:
            label: "Referrer Domain"
            type: string
            hidden: no
      - name: channel
        meta:
          dimension:
            label: "Marketing Channel"
            type: string
            hidden: no
        description: Marketing channel responsible for the user's session, based on custom Marketing Channel logic
      - name: currency_code
        meta:
          dimension:
            label: "Local Currency Code"
            type: string
            hidden: no
      - name: converted_ts
        description: Timestamp for the last conversion event in this session
        meta:
          dimension:
            label: "Conversion Timestamp"
            type: timestamp
            hidden: no
      - name: user_registration_conversion_cycle
        description: Sequence number of the user's account opening conversion cycle. Should contain either a 0 (the user has never opened an account within the timeframe of this dbt model's data extract) or 1 (the session is one that leads-up to or includes the account opening event)
        meta:
          dimension:
            label: "Registration Conversion Cycle"
            type: number
            hidden: no
      - name: user_first_order_conversion_cycle
        description: Sequence number of the user's first order conversion cycle. Should contain either a 0 (the user has never placed an order within the timeframe of this dbt model's data extract) or 1 (the session is one that leads-up to or includes the first order conversion event)
        meta:
          dimension:
            label: "First Order Conversion Cycle"
            type: number
            hidden: no
      - name: user_repeat_order_conversion_cycle
        description: Sequence number of the user's repeat order conversion cycle. Should contain either a 0 (the user has never placed an repeat order within the timeframe of this dbt model's data extract) or any number greater than 0 (the session is one that leads-up to or includes the repeat order conversion event for that repeat order conversion cycle)
        meta:
          dimension:
            label: "Repeat Order Conversion Cycle"
            type: number
            hidden: no
      - name: count_repeat_order_conversions
        description: Total count of repeat order conversion events within the session.
        meta:
          dimension:
            label: "Total Repeat Orders"
            type: number
            hidden: yes
          metrics:
            total_repeat_orders:
              type: sum
              label: "Repeat Orders"
      - name: count_first_order_conversions
        description: Total count of first order conversion events within the session.
        meta:
          dimension:
            label: "Total First Orders"
            type: number
            hidden: yes
          metrics:
            total_first_orders:
              type: sum
              label: "First Orders"
      - name: count_registration_conversions
        description: Total count of account opening conversion events within the session.
        meta:
          dimension:
            label: "Total User Registrations"
            type: number
            hidden: yes
          metrics:
            total_user_registrations:
              type: sum
              label: "User Registrations"
      - name: user_registration_first_click_attrib_conversions
        description: Number of account opening conversions using the First Click Decay attribution model.
        meta:
          dimension:
            label: "Total First Click User Registrations"
            type: number
            hidden: yes
          metrics:
            total_first_click_user_registrations:
              type: sum
              label: "First Click User Registrations"
      - name: user_registration_first_non_direct_click_attrib_conversions
        description: Number of account opening conversions using the First Non-Direct Click attribution model.
        meta:
          dimension:
            label: "Total First Non-Direct Click User Registrations"
            type: number
            hidden: yes
          metrics:
            total_first_non_direct_click_user_registrations:
              type: sum
              label: "First Non-Direct Click User Registrations"
      - name: user_registration_last_click_attrib_conversions
        description: Number of account opening conversions using the Last Click attribution model.
        meta:
          dimension:
            label: "Total Last Click User Registrations"
            type: number
            hidden: yes
          metrics:
            total_last_click_user_registrations:
              type: sum
              label: "Last Click User Registrations"
      - name: user_registration_last_non_direct_click_attrib_conversions
        description: Number of account opening conversions using the Last Non-Direct Click attribution model.
        meta:
          dimension:
            label: "Total Last Non-Direct Click User Registrations"
            type: number
            hidden: yes
          metrics:
            total_last_non_direct_click_user_registrations:
              type: sum
              label: "Last Non-Direct Click User Registrations"
      - name: user_registration_last_paid_click_attrib_conversions
        description: Number of account opening conversions using the Last Paid Click attribution model.
        meta:
          dimension:
            label: "Last Paid Click User Registrations"
            type: number
            hidden: yes
          metrics:
            total_last_paid_click_user_registrations:
              type: sum
              label: "Last Paid Click User Registrations"
      - name: user_registration_even_click_attrib_conversions
        description: Number of account opening conversions using the Even Click attribution model.
        meta:
          dimension:
            label: "Even Click User Registrations"
            type: number
            hidden: yes
          metrics:
            total_even_click_user_registrations:
              type: sum
              label: "Even Click User Registrations"
      - name: user_registration_time_decay_attrib_conversions
        description: Number of account opening conversions using the Time Decay attribution model.
        meta:
          dimension:
            label: "Total Time Decay User Registrations"
            type: number
            hidden: yes
          metrics:
            total_time_decay_user_registrations:
              type: sum
              label: "Time Decay User Registrations"
      - name: first_order_first_click_attrib_conversions
        description: Number of first order conversions using the First Click attribution model.
        meta:
          dimension:
            label: "Total First Click First Orders"
            type: number
            hidden: yes
          metrics:
            total_first_click_orders:
              type: sum
              label: "First Click First Orders"
      - name: first_order_first_non_direct_click_attrib_conversions
        description: Number of first order conversions using the First Non-Direct Click attribution model.
        meta:
          dimension:
            label: "Total First Non-Direct Click First Orders"
            type: number
            hidden: yes
          metrics:
            total_first_click_orders:
              type: sum
              label: "First Non-Direct Click First Orders"
      - name: first_order_first_paid_click_attrib_conversions
        description: Number of first order conversions using the First Paid Click attribution model.
        meta:
          dimension:
            label: "Total First Paid Click First Orders"
            type: number
            hidden: yes
          metrics:
            total_first_paid_click_orders:
              type: sum
              label: "First Paid Click First Orders"
      - name: first_order_last_click_attrib_conversions
        description: Number of first order conversions using the Last Click attribution model.
        meta:
          dimension:
            label: "Total Last Click Orders"
            type: number
            hidden: yes
          metrics:
            total_last_click_orders:
              type: sum
              label: "Last Click First Orders"
      - name: first_order_last_non_direct_click_attrib_conversions
        description: Number of first order conversions using the Last Non-Direct Click attribution model.
        meta:
          dimension:
            label: "Total Last Non-Direct Click First Orders"
            type: number
            hidden: yes
          metrics:
            total_last_non_direct_click_orders:
              type: sum
              label: "Last Non-Direct Click First Orders"
      - name: first_order_even_click_attrib_conversions
        description: Number of first order conversions using the Even Click attribution model.
        meta:
          dimension:
            label: "Total Even Click First Orders"
            type: number
            hidden: yes
          metrics:
            total_even_click_orders:
              type: sum
              label: "Last Even Click First Orders"
      - name: first_order_first_click_attrib_revenue
        meta:
          dimension:
            label: "Total First Click First Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_first_click_order_revenue:
              type: sum
              label: "First Click First Order Revenue"
      - name: first_order_first_non_direct_click_attrib_revenue
        meta:
          dimension:
            label: "Total First Non-Direct Click First Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_first_non_direct_click_order_revenue:
              type: sum
              label: "First Non-Direct Click First Order Revenue"
      - name: first_order_first_paid_click_attrib_revenue
        meta:
          dimension:
            label: "Total First Paid Click First Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_first_paid_click_first_order_revenue:
              type: sum
              label: "First Paid Click First Order Revenue"
      - name: first_order_last_click_attrib_revenue
        meta:
          dimension:
            label: "Total Last Click First Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_last_click_first_order_revenue:
              type: sum
              label: "Last Last Click First Order Revenue"
      - name: first_order_last_non_direct_click_attrib_revenue
        meta:
          dimension:
            label: "Total Last Non-Direct Click First Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_last_non_direct_click_first_order_revenue:
              type: sum
              label: "Last Non-Direct Click First Order Revenue"
      - name: first_order_last_paid_click_attrib_revenue
        meta:
          dimension:
            label: "Total Last Paid Click First Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_last_paid_click_first_order_revenue:
              type: sum
              label: "Last Paid Click First Order Revenue"
      - name: first_order_even_click_attrib_revenue
        meta:
          dimension:
            label: "Total Even Click First Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_even_click_first_order_revenue:
              type: sum
              label: "Even Click First Order Revenue"
      - name: repeat_order_first_click_attrib_conversions
        meta:
          dimension:
            label: "Total First Click Repeat Orders"
            type: number
            hidden: yes
          metrics:
            total_first_click_repeat_orders:
              type: sum
              label: "First Click Repeat Orders"
      - name: repeat_order_first_non_direct_click_attrib_conversions
        meta:
          dimension:
            label: "Total First Non-Direct Click Repeat Orders"
            type: number
            hidden: yes
          metrics:
            total_first_non_direct_click_repeat_orders:
              type: sum
              label: "First Non-Direct Click Repeat Orders"
      - name: repeat_order_last_click_attrib_conversions
        meta:
          dimension:
            label: "Total Last Click Repeat Orders"
            type: number
            hidden: yes
          metrics:
            total_last_click_repeat_orders:
              type: sum
              label: "Last Click Repeat Orders"
      - name: repeat_order_last_non_direct_click_attrib_conversions
        meta:
          dimension:
            label: "Total Last Non-Direct Click Repeat Orders"
            type: number
            hidden: yes
          metrics:
            total_last_non_direct_click_repeat_orders:
              type: sum
              label: "Last Non-Direct Click Repeat Orders"
      - name: repeat_order_last_paid_click_attrib_conversions
        meta:
          dimension:
            label: "Total Last Paid Click Repeat Orders"
            type: number
            hidden: yes
          metrics:
            total_last_paid_click_repeat_orders:
              type: sum
              label: "Last Non Paid Click Repeat Orders"
      - name: repeat_order_even_click_attrib_conversions
        meta:
          dimension:
            label: "Total Even Click Repeat Orders"
            type: number
            hidden: yes
          metrics:
            total_even_click_repeat_orders:
              type: sum
              label: "Last Non Paid Click Repeat Orders"
      - name: repeat_order_time_decay_attrib_conversions
        meta:
          dimension:
            label: "Total Time Decay Repeat Orders"
            type: number
            hidden: yes
          metrics:
            total_time_decay_repeat_orders:
              type: sum
              label: "Time Decay Repeat Orders"
      - name: repeat_order_first_click_attrib_revenue
        meta:
          dimension:
            label: "Total First Click Repeat Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_first_click_repeat_order_revenue:
              type: sum
              label: "First Click Repeat Order Revenue"
      - name: repeat_order_first_non_direct_click_attrib_revenue
        meta:
          dimension:
            label: "Total First Non-Direct Repeat Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_first_non_direct_click_repeat_order_revenue:
              type: sum
              label: "First Non-Direct Click Repeat Order Revenue"
      - name: repeat_order_first_paid_click_attrib_revenue
        meta:
          dimension:
            label: "Total First Paid Click Repeat Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_first_paid_click_repeat_order_revenue:
              type: sum
              label: "First Paid Click Repeat Order Revenue"
      - name: repeat_order_last_click_attrib_revenue
        meta:
          dimension:
            label: "Total Last Click Repeat Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_last_click_repeat_order_revenue:
              type: sum
              label: "Last Click Repeat Order Revenue"
      - name: repeat_order_last_non_direct_click_attrib_revenue
        meta:
          dimension:
            label: "Total Last Non-Direct Click Repeat Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_last_non_direct_click_repeat_order_revenue:
              type: sum
              label: "Last Non-Direct Click Repeat Order Revenue"
      - name: repeat_order_last_paid_click_attrib_revenue
        meta:
          dimension:
            label: "Total Last Paid Click Repeat Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_last_paid_click_repeat_order_revenue:
              type: sum
              label: "Last Paid Click Repeat Order Revenue"
      - name: repeat_order_even_click_attrib_revenue
        meta:
          dimension:
            label: "Total Even Click Repeat Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_even_click_repeat_order_revenue:
              type: sum
              label: "Even Click Repeat Order Revenue"
      - name: repeat_order_time_decay_attrib_revenue
        meta:
          dimension:
            label: "Total Time Decay Repeat Order Revenue"
            type: number
            hidden: yes
          metrics:
            total_time_decay_repeat_order_revenue:
              type: sum
              label: "Time Decay Repeat Order Revenue"
